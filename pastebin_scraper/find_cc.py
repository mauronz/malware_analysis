import os
import re

url_re = re.compile("([a-zA-Z0-9]\x00)+\.\x00([a-zA-Z0-9]\x00)+\.\x00([a-zA-Z]\x00){2,3}")
ip_re = re.compile("([0-2]\x00)?([0-9]\x00){2}\.\x00([0-2]\x00)?([0-9]\x00){2}\.\x00([0-2]\x00)?([0-9]\x00){2}")

for name in os.listdir("binaries/"):
	print name
	f = open("binaries/" + name, "r")
	data = f.read()
	#urls = url_re.findall(data)
	#if len(urls) > 0:
	#	print urls
	#	print "\tURLs:"
	#	for url in urls:
	#		print "\t\t" + url.replace("\x00", "")
	res = url_re.search(data)
	if not res is None:
		print "\t" + res.group().replace("\x00", "")

	res = ip_re.search(data)
	if not res is None:
		print "\t" + res.group().replace("\x00", "")
		
